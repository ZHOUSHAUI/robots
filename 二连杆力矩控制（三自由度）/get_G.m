function GG=get_G(s_v) 
global G ulink  I1 I2
g=G; 
m1=ulink.m1;m2=ulink.m2; 
l1=ulink.l1;l2=ulink.l2; 
I1_11=I1(1,1);I1_12=I1(1,2);I1_13=I1(1,3);
I1_21=I1(2,1);I1_22=I1(2,2);I1_23=I1(2,3);
I1_31=I1(3,1);I1_32=I1(3,2);I1_33=I1(3,3);
I2_11=I2(1,1);I2_12=I2(1,2);I2_13=I2(1,3);
I2_21=I2(2,1);I2_22=I2(2,2);I2_23=I2(2,3);
I2_31=I2(3,1);I2_32=I2(3,2);I2_33=I2(3,3);
T1=0;T2=0;T3=0;
q1=s_v(1);q2=s_v(3);q3=s_v(5);w1_z=s_v(2);w2_x=s_v(4);w3_x=s_v(6);
G1=-T1; 
G2=- T2 - g*m2*((l2*sin(q2 + q3))/2 + l1*sin(q2)) - (g*l1*m1*sin(q2))/2; 
G3=- T3 - (g*l2*m2*sin(q2 + q3))/2; 
CG1=(I2_22*sin(2*q2 + 2*q3) - I2_32*cos(2*q2 + 2*q3) - I2_23*cos(2*q2 + 2*q3) - I2_33*sin(2*q2 + 2*q3) - I1_23*cos(2*q2) - I1_32*cos(2*q2) + I1_22*sin(2*q2) - I1_33*sin(2*q2) + (l2^2*m2*sin(2*q2 + 2*q3))/4 + (l1^2*m1*sin(2*q2))/4 + l1^2*m2*sin(2*q2) + l1*l2*m2*sin(2*q2 + q3))*w1_z*w2_x + (I2_22*sin(2*q2 + 2*q3) - I2_32*cos(2*q2 + 2*q3) - I2_23*cos(2*q2 + 2*q3) - I2_33*sin(2*q2 + 2*q3) + (l2^2*m2*sin(2*q2 + 2*q3))/4 - (l1*l2*m2*sin(q3))/2 + (l1*l2*m2*sin(2*q2 + q3))/2)*w1_z*w3_x + (- (I2_12*cos(q2 + q3))/2 - (I2_21*cos(q2 + q3))/2 - (I2_13*sin(q2 + q3))/2 - (I2_31*sin(q2 + q3))/2 - (I1_12*cos(q2))/2 - (I1_21*cos(q2))/2 - (I1_13*sin(q2))/2 - (I1_31*sin(q2))/2)*w2_x^2 + (- I2_12*cos(q2 + q3) - I2_21*cos(q2 + q3) - I2_13*sin(q2 + q3) - I2_31*sin(q2 + q3))*w2_x*w3_x + (- (I2_12*cos(q2 + q3))/2 - (I2_21*cos(q2 + q3))/2 - (I2_13*sin(q2 + q3))/2 - (I2_31*sin(q2 + q3))/2)*w3_x^2 - T1; 
CG2=((I2_23*cos(2*q2 + 2*q3))/2 + (I2_32*cos(2*q2 + 2*q3))/2 - (I2_22*sin(2*q2 + 2*q3))/2 + (I2_33*sin(2*q2 + 2*q3))/2 + (I1_23*cos(2*q2))/2 + (I1_32*cos(2*q2))/2 - (I1_22*sin(2*q2))/2 + (I1_33*sin(2*q2))/2 - (l2^2*m2*sin(2*q2 + 2*q3))/8 - (l1^2*m1*sin(2*q2))/8 - (l1^2*m2*sin(2*q2))/2 - (l1*l2*m2*sin(2*q2 + q3))/2)*w1_z^2 + (-l1*l2*m2*sin(q3))*w2_x*w3_x + (-(l1*l2*m2*sin(q3))/2)*w3_x^2 - (T2 + g*m2*((l2*sin(q2 + q3))/2 + l1*sin(q2)) + (g*l1*m1*sin(q2))/2); 
CG3=((I2_23*cos(2*q2 + 2*q3))/2 + (I2_32*cos(2*q2 + 2*q3))/2 - (I2_22*sin(2*q2 + 2*q3))/2 + (I2_33*sin(2*q2 + 2*q3))/2 - (l2^2*m2*sin(2*q2 + 2*q3))/8 + (l1*l2*m2*sin(q3))/4 - (l1*l2*m2*sin(2*q2 + q3))/4)*w1_z^2 + ((l1*l2*m2*sin(q3))/2)*w2_x^2 - (T3 + (g*l2*m2*sin(q2 + q3))/2); 
GG=[G1;G2;G3;CG1;CG2;CG3]; 
end 
